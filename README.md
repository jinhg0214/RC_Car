# Radio Control Car 구현 프로젝트

2021년 11월 22일 ~ 2021년 11월 26일 

---
# 1. 개요

![화면 캡처 2021-11-27 174106](https://user-images.githubusercontent.com/70011316/143674584-94aeff4a-7333-40fd-9a9a-69279c9bfef6.jpg)
![이미지1](https://user-images.githubusercontent.com/70011316/143674591-e55152d7-4ccd-4d1e-9798-82ffa0c0befe.jpg)

- 라즈베리파이와 AWS를 이용한 무선 조종 차량 구현 프로젝트
- 라즈베이파이4B를 이용하여 각종 모터들로 차량의 움직임을 구현하고, 별도의 센서들을 부착하여 정보들을 수집함.
- 3D 프린팅을 이용하여 차량의 프레임을 제작
- 프로젝트 시연 영상 링크(https://youtu.be/IvJfMl0JzaM)

---

## 2. 본론

## 2-1. 사용 기술 스택   

![사용기술](https://user-images.githubusercontent.com/70011316/143674623-42ca8f34-bc02-4a28-89a4-1260995243b2.png)
- AWS, MySQL, Python3, Pyqt5, Rasberry OS, Google Speech-to-Text, Node.js, Vue

## 2-2. 시스템 설명

### 프로젝트 시나리오   

![이미지2](https://user-images.githubusercontent.com/70011316/143674636-85decec3-0893-4e0e-ba2a-e40d505ef776.jpg)
1. 사용자는 RC 카 조종기를 이용해 차량에 명령을 전송한다.
2. 차량은 이 명령을 수행하여 움직이는 동시에, 각종 센서들을 이용해 데이터들을 수집한다.
3. 수집한 데이터들은 RC카 조종기에 보여주는 동시에, 다른곳에서도 웹 시각화를 통해 보여준다.

### 시스템 구조

- 1.RC Car   
    ![mode3 - 기압,온도,습도 측정](https://user-images.githubusercontent.com/70011316/143674659-3b386d5e-01b1-4b5d-af9e-e5a3cd5ea2bc.jpg)
    - 무선 제어 자동차는 차량의 움직임을 구현하기 위해, DC모터와 서보 모터를 가진다.
        - DC모터는 차량의 전진 및 후진을, 서보 모터는 조향을 담당한다.
        - 이 모터의 제어는 Adafruit-MotorHAT 라이브러리를 이용한다
            - [https://github.com/adafruit/Adafruit-Motor-HAT-Python-Library](https://github.com/adafruit/Adafruit-Motor-HAT-Python-Library)
        - 모터는 전력을 많이 소모하므로, 별도의 전원 보드를 이용하여 관리한다
            - 18650 리튬 이온 배터리 3EA를 이용하여, 전원 모듈에 전원을 공급한다.
            - 전원 모듈은 라즈베리파이4B와 Stepper Motor HAT 로봇 확장보드에 별도로 전원을 공급한다.
    - RC 카는 일정 주기로 AWS의 MySQL 데이터베이스에 접근하여, 명령어 테이블을 확인한다.
        - 수행하지 않은 명령어가 있다면 이를 수행한뒤, 수행 완료로 체크한다.
        - 수행하지 않은 명령어가 여러개 있다면, 가장 최신의 명령어만 수행하고, 나머지는 수행 완료 처리한다. → 충돌 방지
        - 또한 센서를 통해 수집한 정보들을 지속적으로 데이터베이스에 전달한다.
            - 센서햇의 온,습도, 기압 센서를 이용해 수집했다.
            - 별도의 스레드를 이용해 상시로 데이터를 수집하고, 전송하도록 하였다
    - RC카는 다음과 같은 기능들을 가진다
        1. 유튜브 라이브 스트리밍 기능.
            - 리눅스 명령어를 통해 카메라를 활성화 하면, 유튜브 라이브 스트리밍이 가능하다
        - 각종 모드들은 센스햇의 버튼을 누르면 전환 가능하다.
        1.  대기모드
            - 별도의 입력이나 명령이 없으면 센스햇 8*8 LED Matrix에 무지개를 출력한다
        2. 명령어 수행 모드
            - 가장 최근에 수행한 명령어를 아이콘을 통해 보여준다
            - 앞, 뒤, 좌, 우, 정지, 바퀴 중앙정렬, 왼쪽 45', 오른쪽 45' 아이콘
        3. 데이터 수집 모드
            - 센서들을 이용해 얻은 데이터를 LED Matrix에 출력한다.
            - 왼쪽 2줄은 기압, 중앙 2줄은 온도, 오른쪽 2줄은 습도를 출력한다
        4. 기울기 모드
            - 센스햇의 기울기 센서를 이용해 Roll, Pitch, Yaw를 측정한다
            - 센스햇의 LED Matrix에 기울기 변화를 출력한다
            
        
- 2.GUI   
    ![GUI](https://user-images.githubusercontent.com/70011316/143674647-fa42e975-fa44-445b-a9bb-c0b40670261e.jpg)    
    - 라즈베리파이 4B를 이용해 구현.
    - PyQT5를 이용하여 인터페이스를 구현하였다.
    - 인터페이스를 통해 버튼을 누르면, AWS의 데이터베이스 명령어 테이블에 명령을 저장한다.
    - 또한, DB의 명령어 테이블에 저장되어 있는 명령어들과, 센싱 테이블로부터 데이터를 가져와 
    데이터들을 GUI에 출력한다.
- 3.WEB Visualizer   
    ![web](https://user-images.githubusercontent.com/70011316/143674661-bc836aff-c7ea-4eb3-8b9c-dc21c8dfd4a3.gif)
    - DB의 값을 읽고, 이를 시각화 하는 웹사이트를 구성하였다.
    - Node.js기반 Local 웹 서버를 운영하였다.
    - Node.js로 DB에 접속한 후에, DB서버에서 Client로 데이터를 실시간으로 전송한다.
    - 이렇게 얻어낸 데이터를 Vue.js를 통해 차트로 시각화하였다.

# 3. 보완점

1. WiFi를 이용하여 기기와 서버의 통신을 구현했다. WiFi는 공유기 근처에서만 사용할 수 있으므로, LPWAN이나 다른 통신 방법을 고려해봐야 할 것이다.
2.  센스햇을 이용하여 인포테인먼트를 구현했다. 그러나 센서를 더 달기가 어려워서 정보 수집에는 부적합했다. 다음에는 미세먼지 측정 센서나, 가스 센서등 다양한 센서들을 부착해 유용한 위험물 감지 차량을 만들어보는것도 좋을것 같다
3. 차량의 모터의 출력이 약해 실제 구동시 생각보다 조작이 어려웠다. 서버 통신간의 지연도 약간 문제가 있어 실시간 제어는 어려웠다.  
4. 깜빡이 기능이나, 부저로 사운드 출력등을 구현했으면 좋았을 것 같다
5. GUI의 데이터들을 Table을 이용해 깔끔하게 출력했으면
6. 센스햇을 이용해 메세지를 전달해 출력하는 기능이 있었으면, 
    - 센스햇에 메세지를 출력할 때 조작이 씹히는 문제가 있었다. 이를 구현하려면 스레드 기능을 이용해야 했을것이다
7. 다이얼로 서보 모터를 조절하면 진짜 핸들처럼 구현이 가능했을것 같다
8. 슬라이드바로  DC모터를 조절했으면 1,2,3단처럼 뚝뚝 끊기는 기어가 아니라 부드럽게 속도를 제어할 수 있었을 것 같다
9. 카메라에 서보 모터를 부착하여 카메라의 각도를 조절했으면 좋았을 것 같다
